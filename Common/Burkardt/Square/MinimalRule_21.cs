using Burkardt.Types;

namespace Burkardt.Square
{
    public static partial class MinimalRule
    {
        public static double[] smr21()

            //****************************************************************************80
            //
            //  Purpose:
            //
            //    SMR21 returns the SMR rule of degree 21.
            //
            //  Discussion:
            //
            //    DEGREE: 21
            //    ROTATIONALLY INVARIANT: (X,  Y),  (-Y,  X),  (-X, -Y),  (Y, -X).
            //    POINTS CARDINALITY: 81
            //    NORM INF MOMS. RESIDUAL: 4.44089e-15
            //    SUM NEGATIVE WEIGHTS: 0.00000e+00,  
            //
            //  Licensing:
            //
            //    This code is distributed under the GNU LGPL license.
            //
            //  Modified:
            //
            //    21 February 2018
            //
            //  Author:
            //
            //    Original MATLAB version by Mattia Festa, Alvise Sommariva,
            //    C++ version by John Burkardt.
            //
            //  Reference:
            //
            //    Mattia Festa, Alvise Sommariva,
            //    Computing almost minimal formulas on the square,
            //    Journal of Computational and Applied Mathematics,
            //    Volume 17, Number 236, November 2012, pages 4296-4302.
            //
            //  Parameters:
            //
            //    Output, double *SMR21[3*81], the requested rule.
            //
        {
            int degree = 21;
            int order;
            double[] xw =
            {
                2.659786054558319e-01, 2.472943466792205e-01, 1.257081274315271e-01,
                2.966299561078732e-01, 6.837659120145181e-01, 9.195620074644660e-02,
                3.476456848560975e-01, 9.391305012893792e-01, 3.823913002575823e-02,
                5.204899365134467e-01, 4.701056221362075e-01, 9.955659700462254e-02,
                5.565331479249288e-01, 8.299687476559192e-01, 5.711233679557120e-02,
                5.608625825041144e-01, 9.938235381537796e-01, 8.125409684532186e-03,
                7.107545267842089e-01, 2.218786231241980e-01, 8.989795633682901e-02,
                7.323028382034139e-01, 6.675759613958541e-01, 6.285712965516167e-02,
                7.248337121391071e-01, 9.556008374660931e-01, 2.068885521020362e-02,
                8.678958423780866e-01, 4.595394054487673e-01, 5.463376630254965e-02,
                8.501142309217191e-01, 8.692220828069680e-01, 2.950403142043507e-02,
                9.142859758630335e-01, 9.852274923275850e-01, 6.850217129206400e-03,
                9.537223544012101e-01, 2.050108803358328e-01, 3.630414793101230e-02,
                9.934425198626209e-01, 5.102048128337472e-01, 1.110556726680624e-02,
                9.448573049959050e-01, 7.218738735054576e-01, 2.723130314700101e-02,
                9.865716562931908e-01, 8.882998675210052e-01, 6.165546352541271e-03,
                9.790570750021207e-01, 9.587134606894607e-01, 2.900715554613127e-03,
                1.944817128807972e-02, 4.950400647800665e-01, 1.165426493105556e-01,
                5.600805589569329e-02, 8.501230581964183e-01, 6.754741413634147e-02,
                1.000588448960449e-01, 9.908677016040155e-01, 1.332984242008183e-02,
                -2.472943466792205e-01, 2.659786054558319e-01, 1.257081274315271e-01,
                -6.837659120145181e-01, 2.966299561078732e-01, 9.195620074644660e-02,
                -9.391305012893792e-01, 3.476456848560975e-01, 3.823913002575823e-02,
                -4.701056221362075e-01, 5.204899365134467e-01, 9.955659700462254e-02,
                -8.299687476559192e-01, 5.565331479249288e-01, 5.711233679557120e-02,
                -9.938235381537796e-01, 5.608625825041144e-01, 8.125409684532186e-03,
                -2.218786231241980e-01, 7.107545267842089e-01, 8.989795633682901e-02,
                -6.675759613958541e-01, 7.323028382034139e-01, 6.285712965516167e-02,
                -9.556008374660931e-01, 7.248337121391071e-01, 2.068885521020362e-02,
                -4.595394054487673e-01, 8.678958423780866e-01, 5.463376630254965e-02,
                -8.692220828069680e-01, 8.501142309217191e-01, 2.950403142043507e-02,
                -9.852274923275850e-01, 9.142859758630335e-01, 6.850217129206400e-03,
                -2.050108803358328e-01, 9.537223544012101e-01, 3.630414793101230e-02,
                -5.102048128337472e-01, 9.934425198626209e-01, 1.110556726680624e-02,
                -7.218738735054576e-01, 9.448573049959050e-01, 2.723130314700101e-02,
                -8.882998675210052e-01, 9.865716562931908e-01, 6.165546352541271e-03,
                -9.587134606894607e-01, 9.790570750021207e-01, 2.900715554613127e-03,
                -4.950400647800665e-01, 1.944817128807972e-02, 1.165426493105556e-01,
                -8.501230581964183e-01, 5.600805589569329e-02, 6.754741413634147e-02,
                -9.908677016040155e-01, 1.000588448960449e-01, 1.332984242008183e-02,
                -2.659786054558319e-01, -2.472943466792205e-01, 1.257081274315271e-01,
                -2.966299561078732e-01, -6.837659120145181e-01, 9.195620074644660e-02,
                -3.476456848560975e-01, -9.391305012893792e-01, 3.823913002575823e-02,
                -5.204899365134467e-01, -4.701056221362075e-01, 9.955659700462254e-02,
                -5.565331479249288e-01, -8.299687476559192e-01, 5.711233679557120e-02,
                -5.608625825041144e-01, -9.938235381537796e-01, 8.125409684532186e-03,
                -7.107545267842089e-01, -2.218786231241980e-01, 8.989795633682901e-02,
                -7.323028382034139e-01, -6.675759613958541e-01, 6.285712965516167e-02,
                -7.248337121391071e-01, -9.556008374660931e-01, 2.068885521020362e-02,
                -8.678958423780866e-01, -4.595394054487673e-01, 5.463376630254965e-02,
                -8.501142309217191e-01, -8.692220828069680e-01, 2.950403142043507e-02,
                -9.142859758630335e-01, -9.852274923275850e-01, 6.850217129206400e-03,
                -9.537223544012101e-01, -2.050108803358328e-01, 3.630414793101230e-02,
                -9.934425198626209e-01, -5.102048128337472e-01, 1.110556726680624e-02,
                -9.448573049959050e-01, -7.218738735054576e-01, 2.723130314700101e-02,
                -9.865716562931908e-01, -8.882998675210052e-01, 6.165546352541271e-03,
                -9.790570750021207e-01, -9.587134606894607e-01, 2.900715554613127e-03,
                -1.944817128807972e-02, -4.950400647800665e-01, 1.165426493105556e-01,
                -5.600805589569329e-02, -8.501230581964183e-01, 6.754741413634147e-02,
                -1.000588448960449e-01, -9.908677016040155e-01, 1.332984242008183e-02,
                2.472943466792205e-01, -2.659786054558319e-01, 1.257081274315271e-01,
                6.837659120145181e-01, -2.966299561078732e-01, 9.195620074644660e-02,
                9.391305012893792e-01, -3.476456848560975e-01, 3.823913002575823e-02,
                4.701056221362075e-01, -5.204899365134467e-01, 9.955659700462254e-02,
                8.299687476559192e-01, -5.565331479249288e-01, 5.711233679557120e-02,
                9.938235381537796e-01, -5.608625825041144e-01, 8.125409684532186e-03,
                2.218786231241980e-01, -7.107545267842089e-01, 8.989795633682901e-02,
                6.675759613958541e-01, -7.323028382034139e-01, 6.285712965516167e-02,
                9.556008374660931e-01, -7.248337121391071e-01, 2.068885521020362e-02,
                4.595394054487673e-01, -8.678958423780866e-01, 5.463376630254965e-02,
                8.692220828069680e-01, -8.501142309217191e-01, 2.950403142043507e-02,
                9.852274923275850e-01, -9.142859758630335e-01, 6.850217129206400e-03,
                2.050108803358328e-01, -9.537223544012101e-01, 3.630414793101230e-02,
                5.102048128337472e-01, -9.934425198626209e-01, 1.110556726680624e-02,
                7.218738735054576e-01, -9.448573049959050e-01, 2.723130314700101e-02,
                8.882998675210052e-01, -9.865716562931908e-01, 6.165546352541271e-03,
                9.587134606894607e-01, -9.790570750021207e-01, 2.900715554613127e-03,
                4.950400647800665e-01, -1.944817128807972e-02, 1.165426493105556e-01,
                8.501230581964183e-01, -5.600805589569329e-02, 6.754741413634147e-02,
                9.908677016040155e-01, -1.000588448960449e-01, 1.332984242008183e-02,
                0.000000000000000e+00, 0.000000000000000e+00, 1.349722245528155e-01
            };
            double[] xw_copy;

            order = square_minimal_rule_order(degree);
            xw_copy = typeMethods.r8mat_copy_new(3, order, xw);

            return xw_copy;
        }
    }
}