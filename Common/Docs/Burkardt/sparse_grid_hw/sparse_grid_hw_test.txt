26 February 2014 01:50:15 PM

SPARSE_GRID_HW_PRB
  C++ version
  Test the SPARSE_GRID_HW library.

CCL_TEST:
  CCL_ORDER + CC
  Clenshaw Curtis Linear (CCL) quadrature over [0,1]:

   Level   Nodes    Estimate  Error

   1       1        0.193334      0.00977527
   2       3        0.191473     5.68167e-05
   3       5        0.191462     3.95965e-08
   4       7        0.191462     1.17826e-11
   5       9        0.191462     6.52348e-15

CCL_SPARSE_TEST:
  CCL_ORDER + CC
  Sparse Clenshaw Curtis Linear quadrature over [0,1].

   D  Level   Nodes    SG error    MC error

  10      2      21  0.00390989   0.0258782
  10      3     221  6.45374e-05  0.00789979
  10      4    1581  1.23817e-07   0.0028176
  10      5    8761  1.00775e-08  0.00122981
  10      6   40425  8.84205e-11  0.000568074
  10      7  162385  2.90642e-12  0.000293862

CCS_TEST:
  CCS_ORDER + CC
  Clenshaw Curtis Slow quadrature over [0,1]:

   Level   Nodes    Estimate  Error

   1       1        0.193334      0.00977527
   2       3        0.191473     5.68167e-05
   3       5        0.191462     3.95965e-08
   4       9        0.191462     6.52348e-15
   5       9        0.191462     6.52348e-15

CCS_SPARSE_TEST:
  CCS_ORDER + CC
  Sparse Clenshaw Curtis Slow quadrature over [0,1].

   D  Level   Nodes    SG error    MC error

  10      2      21  0.00390989   0.0258782
  10      3     221  6.45374e-05  0.00789979
  10      4    1581  1.23688e-07   0.0028176
  10      5    8721  1.00886e-08  0.00125521
  10      6   39665  8.86452e-11  0.000575534
  10      7  155105  1.10943e-12  0.000297318

CCE_TEST:
  CCE_ORDER + CC
  Clenshaw Curtis Exponential quadrature over [0,1]:

   Level   Nodes    Estimate  Error

   1       1        0.193334      0.00977527
   2       3        0.191473     5.68167e-05
   3       5        0.191462     3.95965e-08
   4       9        0.191462     6.52348e-15
   5      17        0.191462     2.89932e-16

CCE_SPARSE_TEST:
  CCE_ORDER + CC
  Sparse Clenshaw Curtis Exponential quadrature over [0,1].

   D  Level   Nodes    SG error    MC error

  10      2      21  0.00390989   0.0258782
  10      3     221  6.45374e-05  0.00789979
  10      4    1581  1.23688e-07   0.0028176
  10      5    8801  1.00888e-08  0.00122157
  10      6   41265  8.87196e-11  0.000563751
  10      7  171425  2.86464e-12  0.000279777

GET_SEQ_TEST
  GET_SEQ returns all D-dimensional vectors that sum to NORM.

  D = 3
  NORM = 6

  The compositions

  Col:       0       1       2
  Row

    0:       4       1       1
    1:       3       2       1
    2:       3       1       2
    3:       2       3       1
    4:       2       2       2
    5:       2       1       3
    6:       1       4       1
    7:       1       3       2
    8:       1       2       3
    9:       1       1       4


GQN_TEST:
  Gauss-Hermite quadrature over (-oo,+oo):

   Level   Nodes    Estimate  Error

   1       1               0               1
   2       2               1        0.933333
   3       3               9             0.4
   4       4              15     4.73695e-16
   5       5              15     2.36848e-16

GQN_SPARSE_TEST:
  GQN sparse grid:
  Sparse Gaussian quadrature with Hermite weight over (-oo,+oo).

   D  Level   Nodes    SG error    MC error

  10      2      21    0.933333     1.23671
  10      3     221         0.4    0.498557
  10      4    1581  5.82645e-14    0.167225
  10      5    8761  1.46135e-13   0.0754892
  10      6   40405  2.35971e-12   0.0344189
  10      7  162025  1.61097e-11   0.0169912

GQN2_SPARSE_TEST:
  GQN sparse grid:
  Gauss-Hermite sparse grids over (-oo,+oo).
  Use GQN2_ORDER, the growth rule N = 2 * L - 1.

     J      W                X               Y

     0        0.166667        -1.73205               0
     1        0.166667               0        -1.73205
     2        0.333333               0               0
     3        0.166667               0         1.73205
     4        0.166667         1.73205               0

     J      W                X               Y

     0       0.0112574        -2.85697               0
     1       0.0277778        -1.73205        -1.73205
     2      -0.0555556        -1.73205               0
     3       0.0277778        -1.73205         1.73205
     4        0.222076        -1.35563               0
     5       0.0112574               0        -2.85697
     6      -0.0555556               0        -1.73205
     7        0.222076               0        -1.35563
     8        0.177778               0               0
     9        0.222076               0         1.35563
    10      -0.0555556               0         1.73205
    11       0.0112574               0         2.85697
    12        0.222076         1.35563               0
    13       0.0277778         1.73205        -1.73205
    14      -0.0555556         1.73205               0
    15       0.0277778         1.73205         1.73205
    16       0.0112574         2.85697               0

     J      W                X               Y

     0     0.000548269        -3.75044               0
     1      0.00187624        -2.85697        -1.73205
     2     -0.00375247        -2.85697               0
     3      0.00187624        -2.85697         1.73205
     4       0.0307571        -2.36676               0
     5      0.00187624        -1.73205        -2.85697
     6      -0.0277778        -1.73205        -1.73205
     7       0.0370127        -1.73205        -1.35563
     8      -0.0222222        -1.73205               0
     9       0.0370127        -1.73205         1.35563
    10      -0.0277778        -1.73205         1.73205
    11      0.00187624        -1.73205         2.85697
    12       0.0370127        -1.35563        -1.73205
    13      -0.0740253        -1.35563               0
    14       0.0370127        -1.35563         1.73205
    15        0.240123        -1.15441               0
    16     0.000548269               0        -3.75044
    17     -0.00375247               0        -2.85697
    18       0.0307571               0        -2.36676
    19      -0.0222222               0        -1.73205
    20      -0.0740253               0        -1.35563
    21        0.240123               0        -1.15441
    22        0.114286               0               0
    23        0.240123               0         1.15441
    24      -0.0740253               0         1.35563
    25      -0.0222222               0         1.73205
    26       0.0307571               0         2.36676
    27     -0.00375247               0         2.85697
    28     0.000548269               0         3.75044
    29        0.240123         1.15441               0
    30       0.0370127         1.35563        -1.73205
    31      -0.0740253         1.35563               0
    32       0.0370127         1.35563         1.73205
    33      0.00187624         1.73205        -2.85697
    34      -0.0277778         1.73205        -1.73205
    35       0.0370127         1.73205        -1.35563
    36      -0.0222222         1.73205               0
    37       0.0370127         1.73205         1.35563
    38      -0.0277778         1.73205         1.73205
    39      0.00187624         1.73205         2.85697
    40       0.0307571         2.36676               0
    41      0.00187624         2.85697        -1.73205
    42     -0.00375247         2.85697               0
    43      0.00187624         2.85697         1.73205
    44     0.000548269         3.75044               0

GQU_TEST:
  Gauss-Legendre quadrature over [0,1]:

   Level   Nodes    Estimate  Error

   1       1        0.193334      0.00977527
   2       2        0.191455      3.7965e-05
   3       3        0.191462     9.46584e-08
   4       4        0.191462     1.74249e-10
   5       5        0.191462     2.54416e-13

GQU_SPARSE_TEST:
  GQU sparse grid:
  Sparse Gaussian unweighted quadrature over [0,1].

   D  Level   Nodes    SG error    MC error

  10      2      21  0.00494443   0.0258782
  10      3     221  0.000155187  0.00789979
  10      4    1581  3.57517e-06   0.0028176
  10      5    8761  6.46636e-08  0.00122981
  10      6   40405  9.57024e-10  0.000581704
  10      7  162025  1.75903e-11  0.000287111

KPN_TEST:
  Kronrod-Patterson-Hermite quadrature over (-oo,+oo):

   Level   Nodes    Estimate  Error

   1       1               0               1
   2       3               9             0.4
   3       3               9             0.4
   4       7              15     4.73695e-16
   5       9              15     2.36848e-16

KPN_SPARSE_TEST:
  KPN sparse grid:
  Sparse Kronrod-Patterson quadrature with Hermite weight over (-oo,+oo).

   D  Level   Nodes    SG error    MC error

  10      2      21         0.4     1.23671
  10      3     201         0.4    0.537103
  10      4    1201  2.96059e-15    0.200175
  10      5    5301  7.07582e-13   0.0966577
  10      6   19485  7.22906e-12   0.0506963
  10      7   63405  8.71227e-11   0.0269629

KPU_TEST:
  Kronrod-Patterson quadrature over [0,1]:

   Level   Nodes    Estimate  Error

   1       1        0.193334      0.00977527
   2       3        0.191462     9.46584e-08
   3       3        0.191462     9.46584e-08
   4       7        0.191462     4.34898e-16
   5       7        0.191462     4.34898e-16

KPU_SPARSE_TEST:
  KPU sparse grid:
  Sparse Kronrod-Patterson unweighted quadrature over [0,1].

   D  Level   Nodes    SG error    MC error

  10      2      21  0.00452901   0.0258782
  10      3     201  0.000118923  0.00840541
  10      4    1201  2.09585e-06  0.00327686
  10      5    5281  2.68308e-08   0.0016055
  10      6   19105  2.67746e-10  0.000821658
  10      7   60225  6.42504e-12  0.000475706

NWSPGR_SIZE_TEST:
  NWSPGR_SIZE returns the size of a sparse grid, based on either:
  one of the built-in 1D rules, or a family of 1D rules
  supplied by the user.

  Kronrod-Patterson, [0,1], Dim 2, Level 3, Symmetric

  Full          21

  Kronrod-Patterson, (-oo,+oo), Dim 2, Level 3, Symmetric

  Full          21

  Gauss-Legendre, [0,1], Dim 2, Level 3, Symmetric

  Full          14

  Gauss Hermite, (-oo,+oo), [0,1], Dim 2, Level 3, Symmetric

  Full          14

  Clenshaw Curtis Exponential, [-1,+1], [0,1], Dim 2, Level 3, Unsymmetric

  Full          25

  Dimension / Level table for Clenshaw Curtis Exponential

 Dim:        1       2       3       4       5       6       7       8       9      10
Level
   1         1       1       1       1       1       1       1       1       1       1
   2         3       7      10      13      16      19      22      25      28      31
   3         5      25      52      87     131     184     246     317     397     486
   4         9      67     195     411     746    1228    1884    2741    3826    5166
   5        17     161     609    1573    3376    6430   11222   18319   28369   42101

  This function measures the time in seconds required by NWSPGR
  to compute a sparse grid, based on either:
  one of the built-in 1D rules, or a family of 1D rules
  supplied by the user.

  Kronrod-Patterson, [0,1], Dim 20, Level 5, Symmetric

  Full          5.69

  Kronrod-Patterson, (-oo,+oo), Dim 20, Level 5, Symmetric

  Full          5.74

  Gauss-Legendre, [0,1], Dim 20, Level 5, Symmetric

  Full          1.25

  Gauss Hermite, (-oo,+oo), [0,1], Dim 20, Level 5, Symmetric

  Full          1.25

  Clenshaw Curtis Exponential, [-1,+1], [0,1], Dim 20, Level 5, Unsymmetric

  Full          6.5

  Dimension / Level table for Clenshaw Curtis Exponential

 Dim:        1       2       3       4       5       6       7       8       9      10
Level
   1             0           0           0           0           0           0           0           0           0           0
   2             0           0           0           0           0           0           0           0           0           0
   3             0           0           0           0           0           0           0           0           0           0
   4             0           0           0           0           0        0.01           0        0.01        0.01        0.02
   5             0           0           0           0        0.01        0.02        0.03        0.06         0.1        0.17

 Dim:       11      12      13      14      15      16      17      18      19      20
Level
   1             0           0           0           0           0           0           0           0           0           0
   2             0           0           0           0        0.01           0           0           0           0           0
   3             0           0           0        0.01           0        0.01        0.01        0.01        0.01        0.01
   4          0.03        0.03        0.06        0.06        0.09        0.12        0.15        0.21        0.26        0.33
   5          0.28        0.44        0.66        0.94        1.33        1.97        2.66        3.74        5.05        6.57

NWSPGR_TEST:
  NWSPGR generates a sparse grid, based on either:
  one of the built-in 1D rules, or a family of 1D rules
  supplied by the user.

  Kronrod-Patterson, [0,1], Dim 2, Level 3

   0   0.0771605 * f (0.112702,0.112702 )
   1    0.123457 * f (0.112702,0.5 )
   2   0.0771605 * f (0.112702,0.887298 )
   3    0.123457 * f (0.5,0.112702 )
   4    0.197531 * f (0.5,0.5 )
   5    0.123457 * f (0.5,0.887298 )
   6   0.0771605 * f (0.887298,0.112702 )
   7    0.123457 * f (0.887298,0.5 )
   8   0.0771605 * f (0.887298,0.887298 )

  Kronrod-Patterson, (-oo,+oo), Dim 2, Level 3

   0   0.0277778 * f (-1.73205,-1.73205 )
   1    0.111111 * f (-1.73205,0 )
   2   0.0277778 * f (-1.73205,1.73205 )
   3    0.111111 * f (0,-1.73205 )
   4    0.444444 * f (0,0 )
   5    0.111111 * f (0,1.73205 )
   6   0.0277778 * f (1.73205,-1.73205 )
   7    0.111111 * f (1.73205,0 )
   8   0.0277778 * f (1.73205,1.73205 )

  Gauss-Legendre, [0,1], Dim 2, Level 3

   0    0.277778 * f (0.112702,0.5 )
   1        0.25 * f (0.211325,0.211325 )
   2        -0.5 * f (0.211325,0.5 )
   3        0.25 * f (0.211325,0.788675 )
   4    0.277778 * f (0.5,0.112702 )
   5        -0.5 * f (0.5,0.211325 )
   6    0.888889 * f (0.5,0.5 )
   7        -0.5 * f (0.5,0.788675 )
   8    0.277778 * f (0.5,0.887298 )
   9        0.25 * f (0.788675,0.211325 )
  10        -0.5 * f (0.788675,0.5 )
  11        0.25 * f (0.788675,0.788675 )
  12    0.277778 * f (0.887298,0.5 )

  Gauss Hermite, (-oo,+oo), Dim 2, Level 3

   0    0.166667 * f (-1.73205,0 )
   1        0.25 * f (-1,-1 )
   2        -0.5 * f (-1,0 )
   3        0.25 * f (-1,1 )
   4    0.166667 * f (0,-1.73205 )
   5        -0.5 * f (0,-1 )
   6     1.33333 * f (0,0 )
   7        -0.5 * f (0,1 )
   8    0.166667 * f (0,1.73205 )
   9        0.25 * f (1,-1 )
  10        -0.5 * f (1,0 )
  11        0.25 * f (1,1 )
  12    0.166667 * f (1.73205,0 )

  Clenshaw Curtis Exponential, [-1,+1], Dim 2, Level 3

   0   0.0277778 * f (0,0 )
   1  -0.0222222 * f (0,0.5 )
   2   0.0277778 * f (0,1 )
   3    0.266667 * f (0.146447,0.5 )
   4  -0.0222222 * f (0.5,0 )
   5    0.266667 * f (0.5,0.146447 )
   6  -0.0888889 * f (0.5,0.5 )
   7    0.266667 * f (0.5,0.853553 )
   8  -0.0222222 * f (0.5,1 )
   9    0.266667 * f (0.853553,0.5 )
  10   0.0277778 * f (1,0 )
  11  -0.0222222 * f (1,0.5 )
  12   0.0277778 * f (1,1 )

ORDER_REPORT
  For each family of rules, report:
  L,  the level index,
  RP, the required polynomial precision,
  AP, the actual polynomial precision,
  O,  the rule order (number of points).

  GQN family
  Gauss quadrature, exponential weight, (-oo,+oo)

   L  RP  AP   O

   1   1   1   1
   2   3   3   2
   3   5   5   3
   4   7   7   4
   5   9   9   5
   6  11  11   6
   7  13  13   7
   8  15  15   8
   9  17  17   9
  10  19  19  10
  11  21  21  11
  12  23  23  12
  13  25  25  13
  14  27  27  14
  15  29  29  15
  16  31  31  16
  17  33  33  17
  18  35  35  18
  19  37  37  19
  20  39  39  20
  21  41  41  21
  22  43  43  22
  23  45  45  23
  24  47  47  24
  25  49  49  25

  GQU family
  Gauss quadrature, unit weight, [0,1]

   L  RP  AP   O

   1   1   1   1
   2   3   3   2
   3   5   5   3
   4   7   7   4
   5   9   9   5
   6  11  11   6
   7  13  13   7
   8  15  15   8
   9  17  17   9
  10  19  19  10
  11  21  21  11
  12  23  23  12
  13  25  25  13
  14  27  27  14
  15  29  29  15
  16  31  31  16
  17  33  33  17
  18  35  35  18
  19  37  37  19
  20  39  39  20
  21  41  41  21
  22  43  43  22
  23  45  45  23
  24  47  47  24
  25  49  49  25

  KPN family
  Gauss-Kronrod-Patterson quadrature, exponential weight, (-oo,+oo)

   L  RP  AP   O

   1   1   1   1
   2   3   5   3
   3   5   5   3
   4   7   7   7
   5   9  15   9
   6  11  15   9
   7  13  15   9
   8  15  15   9
   9  17  17  17
  10  19  29  19
  11  21  29  19
  12  23  29  19
  13  25  29  19
  14  27  29  19
  15  29  29  19
  16  31  31  31
  17  33  33  33
  18  35  51  35
  19  37  51  35
  20  39  51  35
  21  41  51  35
  22  43  51  35
  23  45  51  35
  24  47  51  35
  25  49  51  35

  KPU family
  Gauss-Kronrod-Patterson quadrature, unit weight, [0,1]

   L  RP  AP   O

   1   1   1   1
   2   3   5   3
   3   5   5   3
   4   7  11   7
   5   9  11   7
   6  11  11   7
   7  13  23  15
   8  15  23  15
   9  17  23  15
  10  19  23  15
  11  21  23  15
  12  23  23  15
  13  25  47  31
  14  27  47  31
  15  29  47  31
  16  31  47  31
  17  33  47  31
  18  35  47  31
  19  37  47  31
  20  39  47  31
  21  41  47  31
  22  43  47  31
  23  45  47  31
  24  47  47  31
  25  49  95  63

SYMMETRIC_SPARSE_SIZE_TEST
  Given a symmetric sparse grid rule represented only by
  the points with positive values, determine the total number
  of points in the grid.

  For dimension DIM, we report
  R, the number of points in the positive orthant, and
  R2, the total number of points.

       DIM         R        R2

         5         6        11
         5        21        61
         3        23        69

TENSOR_PRODUCT_TEST:
  Given a sequence of 1D quadrature rules, construct the
  tensor product rule.

  A 1D rule over [-1,+1]:

   0           1 * f (-1 )
   1           1 * f (1 )

  A 2D rule over [-1,+1] x [2.0,3.0]:

   0        0.25 * f (-1,2 )
   1        0.25 * f (1,2 )
   2         0.5 * f (-1,2.5 )
   3         0.5 * f (1,2.5 )
   4        0.25 * f (-1,3 )
   5        0.25 * f (1,3 )

  A 3D rule over [-1,+1] x [2.0,3.0] x [10.0,15.0]:

   0       0.625 * f (-1,2,10 )
   1       0.625 * f (1,2,10 )
   2        1.25 * f (-1,2.5,10 )
   3        1.25 * f (1,2.5,10 )
   4       0.625 * f (-1,3,10 )
   5       0.625 * f (1,3,10 )
   6       0.625 * f (-1,2,15 )
   7       0.625 * f (1,2,15 )
   8        1.25 * f (-1,2.5,15 )
   9        1.25 * f (1,2.5,15 )
  10       0.625 * f (-1,3,15 )
  11       0.625 * f (1,3,15 )

TENSOR_PRODUCT_TEST_CELL:
  Given a set of 1D quadrature rules stored in a cell array,
  construct the tensor product rule.

  A 1D rule over [-1,+1]:

   0           1 * f (-1 )
   1           1 * f (1 )

  A 1D rule over [-1,+1]:

   0        0.25 * f (-1,2 )
   1        0.25 * f (1,2 )
   2         0.5 * f (-1,2.5 )
   3         0.5 * f (1,2.5 )
   4        0.25 * f (-1,3 )
   5        0.25 * f (1,3 )

  A 1D rule over [-1,+1]:

   0       0.625 * f (-1,2,10 )
   1       0.625 * f (1,2,10 )
   2        1.25 * f (-1,2.5,10 )
   3        1.25 * f (1,2.5,10 )
   4       0.625 * f (-1,3,10 )
   5       0.625 * f (1,3,10 )
   6       0.625 * f (-1,2,15 )
   7       0.625 * f (1,2,15 )
   8        1.25 * f (-1,2.5,15 )
   9        1.25 * f (1,2.5,15 )
  10       0.625 * f (-1,3,15 )
  11       0.625 * f (1,3,15 )

SPARSE_GRID_HW_PRB
  Normal end of execution.

26 February 2014 02:16:30 PM
